#!/bin/bash

# Define the list of Pokémon
pokemon_list=["bulbasaur", "ivysaur", "venusaur", "charmander", "charmeleon"]
# Define the output directory
output_dir="./pokemon_data"

# API base URL
api_url="https://pokeapi.co/api/v2/pokemon"

# Create the output directory if it doesn't exist
mkdir -p "$output_dir"

# Loop through each Pokémon in the list
for pokemon in "${pokemon_list[@]}"; do
    # Format Pokémon name to lowercase (API requires lowercase names)
    formatted_name=$(echo "$pokemon" | tr '[:upper:]' '[:lower:]')

    # Define the output file name
    output_file="$output_dir/${formatted_name}.json"

    # Make the API request and save the response to a file
    echo "Fetching data for $pokemon..."
    response=$(curl -s -w "%{http_code}" -o "$output_file" "$api_url/$formatted_name")

    # Check if the response was successful (HTTP 200)
    if [ "$response" -eq 200 ]; then
        echo "Data for $pokemon saved to $output_file"
    else
        echo "Failed to fetch data for $pokemon (HTTP status: $response)"
        # Remove the incomplete JSON file
        rm -f "$output_file"
    fi

    # Add a delay between requests to prevent rate-limiting (2 seconds)
    sleep 2
done

echo "Data retrieval complete. All files are stored in the '$output_dir' directory."
